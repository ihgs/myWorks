(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4073:function(e,r,t){Promise.resolve().then(t.bind(t,1118))},2653:function(e,r,t){"use strict";t.d(r,{Z:function(){return w}});var n=t(7437),a=t(3457),i=t(6507),s=t(5770),o=t(9050),d=t(5133),l=t(5884),c=t(2265),u=t(1865),m=t(6002),v=t(5883),x=t(4384),h=t(7924),y=t(7775);let j=(0,h.default)();function f(e){let r,{work:t,clickSave:d}=e,l=(0,c.useContext)(m.X),[h,y]=(0,v.FV)(x.j);l&&(r=l.resolve("recorder"));let{control:j,handleSubmit:f}=(0,u.cI)({defaultValues:{start:"",end:"",item:"",type:"",comment:"",...t}}),p={time:{required:"時間を入力してください"},item:{required:"項目を入力してください"}},w=async e=>{let t=await r.save(e),n=h.map(r=>r.id===e.id?t:r);d(t),y(n)};return(0,n.jsxs)(a.Z,{component:"form",spacing:1.5,onSubmit:f(w),children:[(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(u.Qr,{name:"start",control:j,rules:p.time,render:e=>{var r;let{field:t,fieldState:a}=e;return(0,n.jsx)(s.Z,{...t,sx:{mr:1},type:"text",label:"start",error:a.invalid,helperText:null===(r=a.error)||void 0===r?void 0:r.message,variant:"standard"})}}),(0,n.jsx)(u.Qr,{name:"end",control:j,rules:p.time,render:e=>{var r;let{field:t,fieldState:a}=e;return(0,n.jsx)(s.Z,{...t,sx:{mr:1},type:"text",label:"end",error:a.invalid,helperText:null===(r=a.error)||void 0===r?void 0:r.message,variant:"standard"})}}),(0,n.jsx)(u.Qr,{name:"item",control:j,rules:p.item,render:e=>{var r;let{field:t,fieldState:a}=e;return(0,n.jsx)(s.Z,{...t,sx:{mr:1},type:"item",label:"item",error:a.invalid,helperText:null===(r=a.error)||void 0===r?void 0:r.message,variant:"standard"})}}),(0,n.jsx)(u.Qr,{name:"type",control:j,render:e=>{var r;let{field:t,fieldState:a}=e;return(0,n.jsx)(s.Z,{...t,sx:{mr:1},type:"type",label:"type",error:a.invalid,helperText:null===(r=a.error)||void 0===r?void 0:r.message,variant:"standard"})}})]}),(0,n.jsx)(u.Qr,{name:"comment",control:j,render:e=>{var r;let{field:t,fieldState:a}=e;return(0,n.jsx)(s.Z,{...t,type:"text",label:"comment",error:a.invalid,helperText:null===(r=a.error)||void 0===r?void 0:r.message,multiline:!0,minRows:3})}}),(0,n.jsx)(o.Z,{type:"submit",variant:"contained",name:"save",children:"Save"})]})}function p(e){var r;let{work:t,clickEdit:a,onlyDisplay:s}=e,[u,m]=(0,c.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Z,{container:!0,alignItems:"center",columnSpacing:1,sx:{wordWrap:"break-word"},children:[(0,n.jsxs)(l.Z,{xs:2,children:[t.start," ~ ",t.end]}),(0,n.jsxs)(l.Z,{xs:4,children:[t.item," "]}),(0,n.jsxs)(l.Z,{xs:4,children:[t.type," "]}),(0,n.jsx)(l.Z,{xs:2,spacing:2,children:(0,n.jsxs)(i.Z,{display:"flex",justifyContent:"flex-end",children:[(0,n.jsx)(o.Z,{sx:{m:1},variant:"outlined",onClick:()=>{m(!u)},children:u?"Hidden":"Show"}),!s&&(0,n.jsx)(o.Z,{sx:{m:1},variant:"contained",onClick:()=>a(t),children:"Edit"})]})})]}),u&&(0,n.jsx)(l.Z,{container:!0,children:(0,n.jsx)(l.Z,{xs:12,children:(0,n.jsx)(d.Z,{variant:"outlined",sx:{paddingX:2},children:(0,y.ZP)(j.convert(null!==(r=t.comment)&&void 0!==r?r:"").toString())})})})]})}function w(e){let{work:r,edit:t=!1,onlyDisplay:a=!1}=e,[i,s]=(0,c.useState)(r),[o,d]=(0,c.useState)(t);return(0,c.useEffect)(()=>{s({...r})},[]),(0,n.jsx)(n.Fragment,{children:o?(0,n.jsx)(f,{work:i,clickSave:e=>{s(e),d(!1)}}):(0,n.jsx)(p,{work:i,clickEdit:()=>d(!0),onlyDisplay:a})})}},4384:function(e,r,t){"use strict";t.d(r,{j:function(){return a}});var n=t(5883);let a=(0,n.cn)({key:"workListState",default:[]})},6002:function(e,r,t){"use strict";t.d(r,{X:function(){return a}});var n=t(2265);let a=(0,n.createContext)(void 0)},1621:function(e,r,t){"use strict";t.d(r,{$:function(){return s}});var n=t(7868);class a extends n.ZP{constructor(){super("myWorks"),this.version(1).stores({works:"++id, year, month"})}}let i=new a;class s{async save(e){if(void 0!=e.id&&!(e.id<=-1))return await this.update(e);{delete e.id,e.version=1;let r=await i.works.add(e);return{id:r,...e}}}async update(e){if(void 0==e.version||void 0==e.id)throw Error("Invalid data");let r=await i.works.get(e.id);if((null==r?void 0:r.version)!==e.version)throw Error("Data is old.");return e.version=e.version+1,await i.works.update(e.id,e),{...e}}async listByDay(e,r,t){return await i.works.where({year:e,month:r,day:t}).sortBy("start")}async listByMonth(e,r){return await i.works.where({year:e,month:r}).sortBy("day")}}},1118:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return C}});var n=t(7437),a=t(2685),i=t.n(a),s=t(5539),o=t(1621),d=t(6002),l=t(4124),c=t(9337),u=t(4548),m=t.n(u),v=t(2750);let x=m()();function h(e){let{year:r=x.year(),month:t=x.month()+1,day:a=x.date(),onChange:i}=e;return(0,n.jsx)(l._,{dateAdapter:v.y,adapterLocale:"ja",children:(0,n.jsx)(c.$,{defaultValue:m()().year(r).month(t-1).date(a),format:"YYYY/MM/DD",onChange:e=>{i({year:e.year(),month:e.month()+1,day:e.date()})}})})}var y=t(9050),j=t(2653),f=t(2265),p=t(5883),w=t(4384);let g=0;function Z(e){let r,{date:t}=e,a=(0,f.useContext)(d.X);a&&(r=a.resolve("recorder"));let[i,s]=(0,p.FV)(w.j),o=async()=>{s(await r.listByDay(t.year,t.month,t.day))};return(0,f.useEffect)(()=>{o()},[t]),(0,n.jsxs)(n.Fragment,{children:[i.map(e=>(0,n.jsx)(j.Z,{work:e,edit:void 0===e.start||void 0===e.end},e.id)),(0,n.jsx)(y.Z,{size:"large",variant:"contained",onClick:()=>{let e=i[i.length-1],r={...t,version:0,start:(null==e?void 0:e.end)||"",id:--g};s(i.concat([r]))},sx:{margin:1},children:"+"})]})}var k=t(4033);let S=m()(),b=(e,r)=>null==e?r:parseInt(e)||r;function C(){let e=(0,k.useSearchParams)(),r=(0,s.fH)();r.register({recorder:(0,s.D1)(o.$).singleton()});let t={year:b(e.get("year"),S.year()),month:b(e.get("month"),S.month()+1),day:b(e.get("day"),S.date())},[a,l]=(0,f.useState)(t);return(0,n.jsx)("main",{className:i().main,children:(0,n.jsxs)(d.X.Provider,{value:r,children:[(0,n.jsx)(h,{onChange:e=>{l({...e})},year:t.year,month:t.month,day:t.day}),(0,n.jsx)(Z,{date:a})]})})}},2685:function(){}},function(e){e.O(0,[691,290,804,798,971,472,744],function(){return e(e.s=4073)}),_N_E=e.O()}]);