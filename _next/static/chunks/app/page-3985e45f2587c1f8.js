(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4073:function(e,t,r){Promise.resolve().then(r.bind(r,1118))},7263:function(e,t,r){"use strict";r.d(t,{Z:function(){return k}});var n=r(7437),a=r(3457),i=r(6507),s=r(4384),o=r(8440),d=r(9050),l=r(5133),c=r(5884),u=r(2265),m=r(1865),v=r(6002),x=r(5883),y=r(1875),h=r(7924),p=r(7775),f=r(4548),j=r.n(f);let w=(0,h.default)();function g(e){let t,{work:r,clickSave:l}=e,c=(0,u.useContext)(v.X),[h,p]=(0,x.FV)(y.j),[f,w]=(0,u.useState)([]);c&&(t=c.resolve("recorder"));let{control:g,setValue:Z,handleSubmit:k}=(0,m.cI)({defaultValues:{start:"",end:"",item:"",type:"",comment:"",...r}});(0,u.useEffect)(()=>{let e=async()=>{w(await t.listTypes())};e()},[]);let b={start:{required:"時間を入力してください",pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},end:{pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},item:{required:"項目を入力してください"}},C=async(e,r)=>{var n,a;let i=await t.save(e),s=h.map(t=>t.id===e.id?i:t),o=null==r?void 0:null===(a=r.nativeEvent)||void 0===a?void 0:null===(n=a.submitter)||void 0===n?void 0:n.name;"continue"===o?(Z("id",i.id),Z("version",i.version),l(i,!0)):l(i),p(s)},S=e=>e<8?[0,0]:e<23?[0,15]:e<38?[0,30]:e<53?[0,45]:[1,0],E=(e,t)=>{if(":"===t.key&&t.ctrlKey){let t=j()(),[r,n]=S(t.minute()),a=t.add(r,"hour").minute(n);Z(e,a.format("HH:mm"))}};return(0,n.jsxs)(a.Z,{component:"form",spacing:1.5,onSubmit:k(C),children:[(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(m.Qr,{name:"start",control:g,rules:b.start,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"text",label:"start",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>E("start",e)})}}),(0,n.jsx)(m.Qr,{name:"end",control:g,rules:b.end,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"text",label:"end",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>E("end",e)})}}),(0,n.jsx)(m.Qr,{name:"item",control:g,rules:b.item,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"item",label:"item",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard"})}}),(0,n.jsx)(m.Qr,{name:"type",control:g,render:e=>{let{field:t,fieldState:r}=e;return(0,n.jsx)(o.Z,{...t,name:t.name,ref:t.ref,value:t.value,sx:{mr:1,width:300},freeSolo:!0,options:f.map(e=>e.name),getOptionLabel:e=>e||"",onChange:(e,t)=>{t&&Z("type",t)},renderInput:e=>{var t;return(0,n.jsx)(s.Z,{...e,type:"type",label:"type",error:r.invalid,helperText:null===(t=r.error)||void 0===t?void 0:t.message,variant:"standard",autoComplete:"off"})}})}})]}),(0,n.jsx)(m.Qr,{name:"comment",control:g,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,type:"text",label:"comment",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,multiline:!0,minRows:3})}}),(0,n.jsxs)(a.Z,{direction:"row",justifyContent:"flex-end",spacing:1,children:[(0,n.jsx)(d.Z,{type:"submit",variant:"contained",name:"continue",children:"途中保存"}),(0,n.jsx)(d.Z,{type:"submit",variant:"contained",name:"save",children:"Save"})]})]})}function Z(e){var t;let{work:r,clickEdit:a,onlyDisplay:s}=e,[o,m]=(0,u.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.Z,{container:!0,alignItems:"center",columnSpacing:1,sx:{wordWrap:"break-word"},children:[(0,n.jsxs)(c.Z,{xs:2,children:[r.start," ~ ",r.end]}),(0,n.jsxs)(c.Z,{xs:4,children:[r.item," "]}),(0,n.jsxs)(c.Z,{xs:4,children:[r.type," "]}),(0,n.jsx)(c.Z,{xs:2,spacing:2,children:(0,n.jsxs)(i.Z,{display:"flex",justifyContent:"flex-end",children:[(0,n.jsx)(d.Z,{sx:{m:1},variant:"outlined",onClick:()=>{m(!o)},children:o?"Hidden":"Show"}),!s&&(0,n.jsx)(d.Z,{sx:{m:1},variant:"contained",onClick:()=>a(r),children:"Edit"})]})})]}),o&&(0,n.jsx)(c.Z,{container:!0,children:(0,n.jsx)(c.Z,{xs:12,children:(0,n.jsx)(l.Z,{variant:"outlined",sx:{paddingX:2},children:(0,p.ZP)(w.convert(null!==(t=r.comment)&&void 0!==t?t:"").toString())})})})]})}function k(e){let{work:t,edit:r=!1,onlyDisplay:a=!1}=e,[i,s]=(0,u.useState)(t),[o,d]=(0,u.useState)(r);return(0,u.useEffect)(()=>{s({...t})},[]),(0,n.jsx)(n.Fragment,{children:o?(0,n.jsx)(g,{work:i,clickSave:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(e),d(t)}}):(0,n.jsx)(Z,{work:i,clickEdit:()=>d(!0),onlyDisplay:a})})}},1875:function(e,t,r){"use strict";r.d(t,{j:function(){return a}});var n=r(5883);let a=(0,n.cn)({key:"workListState",default:[]})},1741:function(e,t,r){"use strict";r.d(t,{db:function(){return i}});var n=r(7868);class a extends n.ZP{constructor(){super("myWorks"),this.version(3).stores({works:"++id, [year+month+day], [year+month]",types:"++id"})}}let i=new a},6002:function(e,t,r){"use strict";r.d(t,{X:function(){return a}});var n=r(2265);let a=(0,n.createContext)(void 0)},1485:function(e,t,r){"use strict";r.d(t,{$:function(){return a}});var n=r(1741);class a{async save(e){let t={...e};if(void 0!=t.id&&!(t.id<=-1))return await this.update(t);{delete t.id,t.version=1;let e=await n.db.works.add(t);return{id:e,...t}}}async update(e){if(void 0==e.version||void 0==e.id)throw Error("Invalid data");let t=await n.db.works.get(e.id);if((null==t?void 0:t.version)!==e.version)throw Error("Data is old.");return e.version=e.version+1,await n.db.works.update(e.id,e),{...e}}async list(){throw Error("not implemented")}async listByDay(e,t,r){return await n.db.works.where({year:e,month:t,day:r}).sortBy("start")}async listByMonth(e,t){return await n.db.works.where({year:e,month:t}).sortBy("day")}async delete(e){throw Error("not implemented")}async listTypes(){return await n.db.types.toArray()}}},1118:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(7437),a=r(2685),i=r.n(a),s=r(5539),o=r(1485),d=r(6002),l=r(4124),c=r(2537),u=r(4548),m=r.n(u),v=r(2750);let x=m()();function y(e){let{year:t=x.year(),month:r=x.month()+1,day:a=x.date(),onChange:i}=e;return(0,n.jsx)(l._,{dateAdapter:v.y,adapterLocale:"ja",children:(0,n.jsx)(c.$,{defaultValue:m()().year(t).month(r-1).date(a),format:"YYYY/MM/DD",onChange:e=>{i({year:e.year(),month:e.month()+1,day:e.date()})}})})}var h=r(9050),p=r(7263),f=r(2265),j=r(5883),w=r(1875),g=r(3317);let Z=0;function k(e){let t,{date:r}=e,a=(0,f.useContext)(d.X);a&&(t=a.resolve("recorder"));let[i,s]=(0,j.FV)(w.j),[o,l]=(0,f.useState)(""),c=async()=>{s(await t.listByDay(r.year,r.month,r.day))};return(0,f.useEffect)(()=>{c()},[r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{sx:{m:1},size:"small",variant:"outlined",onClick:()=>{let e=[];i.forEach(t=>{e.push({s:t.start,e:t.end,i:t.item,t:t.type,c:t.comment})}),navigator.clipboard&&(navigator.clipboard.writeText((0,g.Pz)(e)),l("Copied!!"),setTimeout(()=>{l("")},1500))},children:"Copy"}),o,(0,n.jsx)("div",{}),i.map(e=>(0,n.jsx)(p.Z,{work:e,edit:void 0===e.start||void 0===e.end},e.id)),(0,n.jsx)(h.Z,{size:"large",variant:"contained",onClick:()=>{let e=i[i.length-1],t={...r,version:0,start:(null==e?void 0:e.end)||"",id:--Z};s(i.concat([t]))},sx:{margin:1},children:"+"})]})}var b=r(4033);let C=m()(),S=(e,t)=>null==e?t:parseInt(e)||t;function E(){let e=(0,b.useSearchParams)(),t=(0,s.fH)();t.register({recorder:(0,s.D1)(o.$).singleton()});let r={year:S(e.get("year"),C.year()),month:S(e.get("month"),C.month()+1),day:S(e.get("day"),C.date())},[a,l]=(0,f.useState)(r);return(0,n.jsx)("main",{className:i().main,children:(0,n.jsxs)(d.X.Provider,{value:t,children:[(0,n.jsx)(y,{onChange:e=>{l({...e})},year:r.year,month:r.month,day:r.day}),(0,n.jsx)(k,{date:a})]})})}},2685:function(){}},function(e){e.O(0,[691,290,329,862,957,971,472,744],function(){return e(e.s=4073)}),_N_E=e.O()}]);