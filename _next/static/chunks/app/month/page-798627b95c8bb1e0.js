(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[602],{9331:function(e,t,r){Promise.resolve().then(r.bind(r,8988))},7263:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(7437),i=r(3457),a=r(6507),o=r(4384),l=r(8440),s=r(9050),d=r(5133),c=r(5884),u=r(2265),h=r(1865),v=r(6002),m=r(5883),p=r(1875),x=r(7924),f=r(7775),g=r(4548),y=r.n(g);let w=(0,x.default)();function j(e){let t,{work:r,clickSave:d}=e,c=(0,u.useContext)(v.X),[x,f]=(0,m.FV)(p.j),[g,w]=(0,u.useState)([]);c&&(t=c.resolve("recorder"));let{control:j,setValue:Z,handleSubmit:b}=(0,h.cI)({defaultValues:{start:"",end:"",item:"",type:"",comment:"",...r}});(0,u.useEffect)(()=>{let e=async()=>{w(await t.listTypes())};e()},[]);let k={start:{required:"時間を入力してください",pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},end:{pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},item:{required:"項目を入力してください"}},C=async(e,r)=>{var n,i;let a=await t.save(e),o=x.map(t=>t.id===e.id?a:t),l=null==r?void 0:null===(i=r.nativeEvent)||void 0===i?void 0:null===(n=i.submitter)||void 0===n?void 0:n.name;"continue"===l?(Z("id",a.id),Z("version",a.version),d(a,!0)):d(a),f(o)},S=e=>e<8?[0,0]:e<23?[0,15]:e<38?[0,30]:e<53?[0,45]:[1,0],E=(e,t)=>{if(":"===t.key&&t.ctrlKey){let t=y()(),[r,n]=S(t.minute()),i=t.add(r,"hour").minute(n);Z(e,i.format("HH:mm"))}};return(0,n.jsxs)(i.Z,{component:"form",spacing:1.5,onSubmit:b(C),children:[(0,n.jsxs)(a.Z,{children:[(0,n.jsx)(h.Qr,{name:"start",control:j,rules:k.start,render:e=>{var t;let{field:r,fieldState:i}=e;return(0,n.jsx)(o.Z,{...r,sx:{mr:1},type:"text",label:"start",error:i.invalid,helperText:null===(t=i.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>E("start",e)})}}),(0,n.jsx)(h.Qr,{name:"end",control:j,rules:k.end,render:e=>{var t;let{field:r,fieldState:i}=e;return(0,n.jsx)(o.Z,{...r,sx:{mr:1},type:"text",label:"end",error:i.invalid,helperText:null===(t=i.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>E("end",e)})}}),(0,n.jsx)(h.Qr,{name:"item",control:j,rules:k.item,render:e=>{var t;let{field:r,fieldState:i}=e;return(0,n.jsx)(o.Z,{...r,sx:{mr:1},type:"item",label:"item",error:i.invalid,helperText:null===(t=i.error)||void 0===t?void 0:t.message,variant:"standard"})}}),(0,n.jsx)(h.Qr,{name:"type",control:j,render:e=>{let{field:t,fieldState:r}=e;return(0,n.jsx)(l.Z,{...t,name:t.name,ref:t.ref,value:t.value,sx:{mr:1,width:300},freeSolo:!0,options:g.map(e=>e.name),getOptionLabel:e=>e||"",onChange:(e,t)=>{t&&Z("type",t)},renderInput:e=>{var t;return(0,n.jsx)(o.Z,{...e,type:"type",label:"type",error:r.invalid,helperText:null===(t=r.error)||void 0===t?void 0:t.message,variant:"standard",autoComplete:"off"})}})}})]}),(0,n.jsx)(h.Qr,{name:"comment",control:j,render:e=>{var t;let{field:r,fieldState:i}=e;return(0,n.jsx)(o.Z,{...r,type:"text",label:"comment",error:i.invalid,helperText:null===(t=i.error)||void 0===t?void 0:t.message,multiline:!0,minRows:3})}}),(0,n.jsxs)(i.Z,{direction:"row",justifyContent:"flex-end",spacing:1,children:[(0,n.jsx)(s.Z,{type:"submit",variant:"contained",name:"continue",children:"途中保存"}),(0,n.jsx)(s.Z,{type:"submit",variant:"contained",name:"save",children:"Save"})]})]})}function Z(e){var t;let{work:r,clickEdit:i,onlyDisplay:o}=e,[l,h]=(0,u.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.Z,{container:!0,alignItems:"center",columnSpacing:1,sx:{wordWrap:"break-word"},children:[(0,n.jsxs)(c.Z,{xs:2,children:[r.start," ~ ",r.end]}),(0,n.jsxs)(c.Z,{xs:4,children:[r.item," "]}),(0,n.jsxs)(c.Z,{xs:4,children:[r.type," "]}),(0,n.jsx)(c.Z,{xs:2,spacing:2,children:(0,n.jsxs)(a.Z,{display:"flex",justifyContent:"flex-end",children:[(0,n.jsx)(s.Z,{sx:{m:1},variant:"outlined",onClick:()=>{h(!l)},children:l?"Hidden":"Show"}),!o&&(0,n.jsx)(s.Z,{sx:{m:1},variant:"contained",onClick:()=>i(r),children:"Edit"})]})})]}),l&&(0,n.jsx)(c.Z,{container:!0,children:(0,n.jsx)(c.Z,{xs:12,children:(0,n.jsx)(d.Z,{variant:"outlined",sx:{paddingX:2},children:(0,f.ZP)(w.convert(null!==(t=r.comment)&&void 0!==t?t:"").toString())})})})]})}function b(e){let{work:t,edit:r=!1,onlyDisplay:i=!1}=e,[a,o]=(0,u.useState)(t),[l,s]=(0,u.useState)(r);return(0,u.useEffect)(()=>{o({...t})},[]),(0,n.jsx)(n.Fragment,{children:l?(0,n.jsx)(j,{work:a,clickSave:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o(e),s(t)}}):(0,n.jsx)(Z,{work:a,clickEdit:()=>s(!0),onlyDisplay:i})})}},1875:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var n=r(5883);let i=(0,n.cn)({key:"workListState",default:[]})},1741:function(e,t,r){"use strict";r.d(t,{db:function(){return a}});var n=r(7868);class i extends n.ZP{constructor(){super("myWorks"),this.version(3).stores({works:"++id, [year+month+day], [year+month]",types:"++id"})}}let a=new i},6002:function(e,t,r){"use strict";r.d(t,{X:function(){return i}});var n=r(2265);let i=(0,n.createContext)(void 0)},1485:function(e,t,r){"use strict";r.d(t,{$:function(){return i}});var n=r(1741);class i{async save(e){let t={...e};if(void 0!=t.id&&!(t.id<=-1))return await this.update(t);{delete t.id,t.version=1;let e=await n.db.works.add(t);return{id:e,...t}}}async update(e){if(void 0==e.version||void 0==e.id)throw Error("Invalid data");let t=await n.db.works.get(e.id);if((null==t?void 0:t.version)!==e.version)throw Error("Data is old.");return e.version=e.version+1,await n.db.works.update(e.id,e),{...e}}async list(){throw Error("not implemented")}async listByDay(e,t,r){return await n.db.works.where({year:e,month:t,day:r}).sortBy("start")}async listByMonth(e,t){return await n.db.works.where({year:e,month:t}).sortBy("day")}async delete(e){throw Error("not implemented")}async listTypes(){return await n.db.types.toArray()}}},8988:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return H}});var n=r(7437),i=r(2265),a=r(4124),o=r(2537),l=r(4548),s=r.n(l),d=r(2750);let c=s()();function u(e){let{year:t=c.year(),month:r=c.month()+1,onChange:i}=e;return(0,n.jsx)(a._,{dateAdapter:d.y,adapterLocale:"ja",children:(0,n.jsx)(o.$,{openTo:"month",defaultValue:s()().year(t).month(r-1),format:"YYYY/MM",views:["year","month"],onChange:e=>{i({year:e.year(),month:e.month()+1})}})})}var h=r(6507),v=r(9050),m=r(5133),p=r(791),x=r(3428),f=r(7042),g=r(5600),y=r(9975),w=r(5843),j=r(7927),Z=r(6520),b=r(5702);function k(e){return(0,b.Z)("MuiDivider",e)}(0,Z.Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);let C=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],S=e=>{let{absolute:t,children:r,classes:n,flexItem:i,light:a,orientation:o,textAlign:l,variant:s}=e;return(0,g.Z)({root:["root",t&&"absolute",s,a&&"light","vertical"===o&&"vertical",i&&"flexItem",r&&"withChildren",r&&"vertical"===o&&"withChildrenVertical","right"===l&&"vertical"!==o&&"textAlignRight","left"===l&&"vertical"!==o&&"textAlignLeft"],wrapper:["wrapper","vertical"===o&&"wrapperVertical"]},k,n)},E=(0,w.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,"vertical"===r.orientation&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&"vertical"===r.orientation&&t.withChildrenVertical,"right"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignRight,"left"===r.textAlign&&"vertical"!==r.orientation&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>(0,x.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:(0,y.Fq)(e.palette.divider,.08)},"inset"===t.variant&&{marginLeft:72},"middle"===t.variant&&"horizontal"===t.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===t.variant&&"vertical"===t.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===t.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:e})=>(0,x.Z)({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:e,ownerState:t})=>(0,x.Z)({},t.children&&"vertical"!==t.orientation&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`}}),({theme:e,ownerState:t})=>(0,x.Z)({},t.children&&"vertical"===t.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`}}),({ownerState:e})=>(0,x.Z)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),A=(0,w.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.wrapper,"vertical"===r.orientation&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>(0,x.Z)({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},"vertical"===t.orientation&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),D=i.forwardRef(function(e,t){let r=(0,j.Z)({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:o,component:l=a?"div":"hr",flexItem:s=!1,light:d=!1,orientation:c="horizontal",role:u="hr"!==l?"separator":void 0,textAlign:h="center",variant:v="fullWidth"}=r,m=(0,p.Z)(r,C),g=(0,x.Z)({},r,{absolute:i,component:l,flexItem:s,light:d,orientation:c,role:u,textAlign:h,variant:v}),y=S(g);return(0,n.jsx)(E,(0,x.Z)({as:l,className:(0,f.Z)(y.root,o),role:u,ref:t,ownerState:g},m,{children:a?(0,n.jsx)(A,{className:y.wrapper,ownerState:g,children:a}):null}))});D.muiSkipListHighlight=!0;var I=r(5884),T=r(7263),L=r(4033);let R=e=>{if(!e)return 0;let t=e.match(/(\d+):(\d+)/);if(t){let e=t[1],r=t[2];return 60*parseInt(e)+parseInt(r)}return 0};function $(e){let{year:t,month:r,day:a,works:o}=e,[l,s]=(0,i.useState)(!1),d=(0,L.useRouter)(),c=0;o.forEach(e=>{let t=R(e.end),r=R(e.start);c+=t-r});let u=c/60;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.Z,{container:!0,alignItems:"center",children:[(0,n.jsx)(I.Z,{xs:2,children:a}),(0,n.jsxs)(I.Z,{xs:8,children:[u," H"]}),(0,n.jsx)(I.Z,{xs:2,spacing:2,children:(0,n.jsxs)(h.Z,{display:"flex",justifyContent:"flex-end",children:[u>0&&(0,n.jsx)(v.Z,{sx:{m:1},variant:"outlined",onClick:()=>{s(!l)},size:"small",children:l?"Hidden":"Show"}),(0,n.jsx)(v.Z,{sx:{m:1},variant:"outlined",size:"small",onClick:()=>{d.push("/?year=".concat(t,"&month=").concat(r,"&day=").concat(a))},children:"Go"})]})})]}),l&&(0,n.jsx)(m.Z,{sx:{marginLeft:2},children:(()=>{let e=[];return o.forEach(t=>{e.push((0,n.jsx)(T.Z,{work:t,edit:!1,onlyDisplay:!0},t.id))}),e})()}),(0,n.jsx)(D,{})]})}var _=r(6002),B=r(3317);function M(e){let t,{month:r}=e,a=(0,i.useContext)(_.X),[o,l]=(0,i.useState)([]);a&&(t=a.resolve("recorder")),(0,i.useEffect)(()=>{let e=async()=>{let e=[],n=s()().year(r.year).month(r.month-1).date(1).endOf("month");for(let t=0;t<n.date();t++)e[t]=[];let i=await t.listByMonth(r.year,r.month);i.forEach(t=>{e[t.day-1].push(t)}),l(e)};e()},[r]);let[d,c]=(0,i.useState)("");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{sx:{m:1},size:"small",variant:"outlined",onClick:()=>{let e={};o.forEach((t,n)=>{let i=[];t.forEach(e=>{i.push({s:e.start,e:e.end,i:e.item,t:e.type,c:e.comment})});let a="_".concat(r.year,"_").concat(r.month,"_").concat(n+1);e[a]=i}),navigator.clipboard&&(navigator.clipboard.writeText((0,B.Pz)(e)),c("Copied!!"),setTimeout(()=>{c("")},1500))},children:"Copy"}),d,(0,n.jsx)("div",{}),o.map((e,t)=>(0,n.jsx)($,{year:r.year,month:r.month,day:t+1,works:e},"".concat(r.year,"-").concat(t)))]})}var V=r(5539),W=r(1485);let F=s()();function H(){let e=(0,V.fH)();e.register({recorder:(0,V.D1)(W.$).singleton()});let[t,r]=(0,i.useState)({year:F.year(),month:F.month()+1});return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(_.X.Provider,{value:e,children:[(0,n.jsx)(u,{onChange:e=>{r({...e})}}),(0,n.jsx)(M,{month:t})]})})}}},function(e){e.O(0,[691,290,329,862,957,971,472,744],function(){return e(e.s=9331)}),_N_E=e.O()}]);