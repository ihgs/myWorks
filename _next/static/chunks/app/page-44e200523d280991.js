(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4073:function(e,t,r){Promise.resolve().then(r.bind(r,1118))},2653:function(e,t,r){"use strict";r.d(t,{Z:function(){return Z}});var n=r(7437),a=r(3457),i=r(6507),s=r(5770),o=r(9050),d=r(5133),l=r(5884),c=r(2265),u=r(1865),m=r(6002),v=r(5883),x=r(4384),h=r(7924),y=r(7775),f=r(4548),j=r.n(f);let p=(0,h.default)();function w(e){let t,{work:r,clickSave:d}=e,l=(0,c.useContext)(m.X),[h,y]=(0,v.FV)(x.j);l&&(t=l.resolve("recorder"));let{control:f,setValue:p,handleSubmit:w}=(0,u.cI)({defaultValues:{start:"",end:"",item:"",type:"",comment:"",...r}}),g={start:{required:"時間を入力してください",pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},end:{pattern:{value:/\d\d:\d\d/,message:"00:00 形式で入力してください。"}},item:{required:"項目を入力してください"}},Z=async(e,r)=>{var n,a;let i=await t.save(e),s=h.map(t=>t.id===e.id?i:t),o=null==r?void 0:null===(a=r.nativeEvent)||void 0===a?void 0:null===(n=a.submitter)||void 0===n?void 0:n.name;"continue"===o?(p("id",i.id),p("version",i.version),d(i,!0)):d(i),y(s)},k=e=>e<8?[0,0]:e<23?[0,15]:e<38?[0,30]:e<53?[0,45]:[1,0],b=(e,t)=>{if(";"===t.key&&t.ctrlKey&&t.shiftKey){let t=j()(),[r,n]=k(t.minute()),a=t.add(r,"hour").minute(n);p(e,a.format("HH:mm"))}};return(0,n.jsxs)(a.Z,{component:"form",spacing:1.5,onSubmit:w(Z),children:[(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(u.Qr,{name:"start",control:f,rules:g.start,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"text",label:"start",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>b("start",e)})}}),(0,n.jsx)(u.Qr,{name:"end",control:f,rules:g.end,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"text",label:"end",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard",onKeyDown:e=>b("end",e)})}}),(0,n.jsx)(u.Qr,{name:"item",control:f,rules:g.item,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"item",label:"item",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard"})}}),(0,n.jsx)(u.Qr,{name:"type",control:f,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,sx:{mr:1},type:"type",label:"type",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,variant:"standard"})}})]}),(0,n.jsx)(u.Qr,{name:"comment",control:f,render:e=>{var t;let{field:r,fieldState:a}=e;return(0,n.jsx)(s.Z,{...r,type:"text",label:"comment",error:a.invalid,helperText:null===(t=a.error)||void 0===t?void 0:t.message,multiline:!0,minRows:3})}}),(0,n.jsxs)(a.Z,{direction:"row",justifyContent:"flex-end",spacing:1,children:[(0,n.jsx)(o.Z,{type:"submit",variant:"contained",name:"continue",children:"途中保存"}),(0,n.jsx)(o.Z,{type:"submit",variant:"contained",name:"save",children:"Save"})]})]})}function g(e){var t;let{work:r,clickEdit:a,onlyDisplay:s}=e,[u,m]=(0,c.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Z,{container:!0,alignItems:"center",columnSpacing:1,sx:{wordWrap:"break-word"},children:[(0,n.jsxs)(l.Z,{xs:2,children:[r.start," ~ ",r.end]}),(0,n.jsxs)(l.Z,{xs:4,children:[r.item," "]}),(0,n.jsxs)(l.Z,{xs:4,children:[r.type," "]}),(0,n.jsx)(l.Z,{xs:2,spacing:2,children:(0,n.jsxs)(i.Z,{display:"flex",justifyContent:"flex-end",children:[(0,n.jsx)(o.Z,{sx:{m:1},variant:"outlined",onClick:()=>{m(!u)},children:u?"Hidden":"Show"}),!s&&(0,n.jsx)(o.Z,{sx:{m:1},variant:"contained",onClick:()=>a(r),children:"Edit"})]})})]}),u&&(0,n.jsx)(l.Z,{container:!0,children:(0,n.jsx)(l.Z,{xs:12,children:(0,n.jsx)(d.Z,{variant:"outlined",sx:{paddingX:2},children:(0,y.ZP)(p.convert(null!==(t=r.comment)&&void 0!==t?t:"").toString())})})})]})}function Z(e){let{work:t,edit:r=!1,onlyDisplay:a=!1}=e,[i,s]=(0,c.useState)(t),[o,d]=(0,c.useState)(r);return(0,c.useEffect)(()=>{s({...t})},[]),(0,n.jsx)(n.Fragment,{children:o?(0,n.jsx)(w,{work:i,clickSave:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(e),d(t)}}):(0,n.jsx)(g,{work:i,clickEdit:()=>d(!0),onlyDisplay:a})})}},4384:function(e,t,r){"use strict";r.d(t,{j:function(){return a}});var n=r(5883);let a=(0,n.cn)({key:"workListState",default:[]})},6002:function(e,t,r){"use strict";r.d(t,{X:function(){return a}});var n=r(2265);let a=(0,n.createContext)(void 0)},1621:function(e,t,r){"use strict";r.d(t,{$:function(){return s}});var n=r(7868);class a extends n.ZP{constructor(){super("myWorks"),this.version(2).stores({works:"++id, [year+month+day], [year+month]"})}}let i=new a;class s{async save(e){let t={...e};if(void 0!=t.id&&!(t.id<=-1))return await this.update(t);{delete t.id,t.version=1;let e=await i.works.add(t);return{id:e,...t}}}async update(e){if(void 0==e.version||void 0==e.id)throw Error("Invalid data");let t=await i.works.get(e.id);if((null==t?void 0:t.version)!==e.version)throw Error("Data is old.");return e.version=e.version+1,await i.works.update(e.id,e),{...e}}async listByDay(e,t,r){return await i.works.where({year:e,month:t,day:r}).sortBy("start")}async listByMonth(e,t){return await i.works.where({year:e,month:t}).sortBy("day")}}},1118:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=r(7437),a=r(2685),i=r.n(a),s=r(5539),o=r(1621),d=r(6002),l=r(4124),c=r(9337),u=r(4548),m=r.n(u),v=r(2750);let x=m()();function h(e){let{year:t=x.year(),month:r=x.month()+1,day:a=x.date(),onChange:i}=e;return(0,n.jsx)(l._,{dateAdapter:v.y,adapterLocale:"ja",children:(0,n.jsx)(c.$,{defaultValue:m()().year(t).month(r-1).date(a),format:"YYYY/MM/DD",onChange:e=>{i({year:e.year(),month:e.month()+1,day:e.date()})}})})}var y=r(9050),f=r(2653),j=r(2265),p=r(5883),w=r(4384),g=r(3317);let Z=0;function k(e){let t,{date:r}=e,a=(0,j.useContext)(d.X);a&&(t=a.resolve("recorder"));let[i,s]=(0,p.FV)(w.j),[o,l]=(0,j.useState)(""),c=async()=>{s(await t.listByDay(r.year,r.month,r.day))};return(0,j.useEffect)(()=>{c()},[r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{sx:{m:1},size:"small",variant:"outlined",onClick:()=>{let e=[];i.forEach(t=>{e.push({s:t.start,e:t.end,i:t.item,t:t.type,c:t.comment})}),navigator.clipboard&&(navigator.clipboard.writeText((0,g.Pz)(e)),l("Copied!!"),setTimeout(()=>{l("")},1500))},children:"Copy"}),o,(0,n.jsx)("div",{}),i.map(e=>(0,n.jsx)(f.Z,{work:e,edit:void 0===e.start||void 0===e.end},e.id)),(0,n.jsx)(y.Z,{size:"large",variant:"contained",onClick:()=>{let e=i[i.length-1],t={...r,version:0,start:(null==e?void 0:e.end)||"",id:--Z};s(i.concat([t]))},sx:{margin:1},children:"+"})]})}var b=r(4033);let C=m()(),S=(e,t)=>null==e?t:parseInt(e)||t;function E(){let e=(0,b.useSearchParams)(),t=(0,s.fH)();t.register({recorder:(0,s.D1)(o.$).singleton()});let r={year:S(e.get("year"),C.year()),month:S(e.get("month"),C.month()+1),day:S(e.get("day"),C.date())},[a,l]=(0,j.useState)(r);return(0,n.jsx)("main",{className:i().main,children:(0,n.jsxs)(d.X.Provider,{value:t,children:[(0,n.jsx)(h,{onChange:e=>{l({...e})},year:r.year,month:r.month,day:r.day}),(0,n.jsx)(k,{date:a})]})})}},2685:function(){}},function(e){e.O(0,[691,290,804,728,971,472,744],function(){return e(e.s=4073)}),_N_E=e.O()}]);